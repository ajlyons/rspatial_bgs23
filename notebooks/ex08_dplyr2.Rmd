---
title: "R Syntax Review"
output: html_notebook
---

Manipulating Columns with dplyr


## Add a column called "Selected" 

## The service request id is an 8-digit integer. 
## Write an expression  that returns the first four digits of the service request id.


df |> mutate(id_first_four = )

df$service_request_id |> class()

df$service_request_id |> class()


## What class does the requested_datetime column contain?

class(df$requested_datetime)

# Change it do a DateTime Object:

library(lubridate)

"2023-02-21T00:04:21.000" |>  lubridate::ymd_hms()

"2023-02-21T00:04:21.000" |>  lubridate::ymd_hms(tz = "America/Los_Angeles")



df$requested_datetime[1] |> lubridate::ymd_hms()


df |> arrange(requested_datetime) |> head()
df |> 
  top_n(requested_datetime, n=5) |> 
  pull(requested_datetime)

## Q3. When was the last call made?

df |> 
  
  
  
  #######################

url1 <- "https://data.sfgov.org/resource/vw6y-z8j6.csv?$select=service_request_id,agency_responsible,service_name,service_subtype,address,neighborhoods_sffind_boundaries,source&$where=requested_datetime '2023-01-01T00:00:00' and '2023-01-31T23:59:59'"


url1 <- "https://data.sfgov.org/resource/vw6y-z8j6.csv?$select=service_request_id,agency_responsible,service_name,service_subtype,address,neighborhoods_sffind_boundaries,source$limit=10"

# &$where=requested_datetime '2023-01-01T00:00:00' and '2023-01-31T23:59:59'"

df <- read.csv(url1)
names(df)

url2 <- url1 |> URLencode()


df <- read.csv(url2)
